{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Sports Day{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preconnect for faster font loading -->
  <link rel="preconnect" href="https://fonts.cdnfonts.com" crossorigin>

  <!-- Explicit, upright Gotham faces (Book normal + Book Italic).
       Add Medium/Bold below if you decide to use them. -->
  <style>
    @font-face{
      font-family: 'Gotham';
      src: url('https://fonts.cdnfonts.com/s/14898/Gotham-Book.woff2') format('woff2'),
           url('https://fonts.cdnfonts.com/s/14898/Gotham-Book.woff') format('woff');
      font-weight: 400;
      font-style: normal;
      font-display: swap;
    }
    @font-face{
      font-family: 'Gotham';
      src: url('https://fonts.cdnfonts.com/s/14898/Gotham-BookItalic.woff2') format('woff2'),
           url('https://fonts.cdnfonts.com/s/14898/Gotham-BookItalic.woff') format('woff');
      font-weight: 400;
      font-style: italic;
      font-display: swap;
    }
  </style>

  <!-- Tailwind (CDN for now; use CLI/PostCSS in production) -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>

  <!-- HTMX + sortable extension -->
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <script src="https://unpkg.com/htmx.org/dist/ext/sortable.js"></script>

  <!-- Tailwind config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            midnight: '#001844',
            dusk: '#1e293b',
            dawn: '#f8fafc',
            ink: '#000000',
            sky: '#0369a1',
          }
        }
      }
    }
  </script>

  <!-- Theme tokens + base typography -->
  <style>
    :root {
      --sd-bg: #f4f7fb;
      --sd-surface: #ffffff;
      --sd-surface-muted: #f1f5f9;
      --sd-border: #d6e3f3;
      --sd-heading: #001844;
      --sd-text: #000000;
      --sd-text-muted: #475569;
    }

    /* Prevent synthetic italics/weights when a face is missing */
    html { font-synthesis: none; }

    /* Global font stack with safe fallbacks */
    body,
    .sunlight-theme {
      font-family: 'Gotham', 'Helvetica Neue', Arial, sans-serif;
      font-style: normal;
      -webkit-text-size-adjust: 100%;
    }

    body.sunlight-theme {
      background: var(--sd-bg);
      color: var(--sd-text);
    }

    h1,h2,h3,h4,h5,h6 {
      font-family: 'Gotham', 'Helvetica Neue', Arial, sans-serif;
      color: var(--sd-heading);
      letter-spacing: 0.01em;
      font-style: normal;
    }

    /* Sunlight palette overrides for dark-ish Tailwind utility classes */
    .sunlight-theme .bg-slate-900,
    .sunlight-theme .bg-slate-900\/40,
    .sunlight-theme .bg-slate-900\/60,
    .sunlight-theme .bg-slate-900\/70,
    .sunlight-theme .bg-slate-800,
    .sunlight-theme .bg-slate-800\/40,
    .sunlight-theme .bg-slate-800\/60,
    .sunlight-theme .bg-slate-950\/40,
    .sunlight-theme .bg-slate-950\/60,
    .sunlight-theme .bg-slate-950\/70,
    .sunlight-theme .bg-slate-700,
    .sunlight-theme .bg-slate-700\/40,
    .sunlight-theme .bg-slate-700\/60,
    .sunlight-theme .bg-dusk,
    .sunlight-theme .bg-dusk\/80,
    .sunlight-theme .bg-dusk\/95 { background-color: var(--sd-surface) !important; }

    .sunlight-theme .border-slate-800,
    .sunlight-theme .border-slate-700,
    .sunlight-theme .border-slate-600 { border-color: var(--sd-border) !important; }

    .sunlight-theme .divide-slate-800,
    .sunlight-theme .divide-slate-700 { --tw-divide-color: var(--sd-border) !important; }

    .sunlight-theme .text-slate-100,
    .sunlight-theme .text-slate-200,
    .sunlight-theme .text-slate-300,
    .sunlight-theme .text-slate-400 { color: var(--sd-heading) !important; }

    .sunlight-theme .text-slate-500,
    .sunlight-theme .text-slate-600 { color: var(--sd-text-muted) !important; }

    .sunlight-theme .text-sky-200,
    .sunlight-theme .text-sky-300 { color: #0369a1 !important; }

    .sunlight-theme .shadow-slate-900\/40 {
      box-shadow: 0 12px 32px rgba(15, 23, 42, 0.12) !important;
    }

    .sunlight-theme input,
    .sunlight-theme select,
    .sunlight-theme textarea {
      background-color: var(--sd-surface) !important;
      color: var(--sd-text) !important;
      border-color: var(--sd-border) !important;
    }
    .sunlight-theme input:focus,
    .sunlight-theme select:focus,
    .sunlight-theme textarea:focus {
      outline: none;
      box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.2);
      border-color: #0ea5e9 !important;
    }
    .sunlight-theme input::placeholder,
    .sunlight-theme textarea::placeholder { color: #94a3b8 !important; }

    .sunlight-theme .bg-slate-900\/80 { background-color: var(--sd-surface-muted) !important; }
  </style>

  {% block extra_head %}{% endblock %}
</head>

<body class="sunlight-theme bg-dawn text-ink min-h-full flex flex-col">
  <header class="bg-white/90 backdrop-blur border-b border-slate-200 sticky top-0 z-30 shadow-sm">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-4 flex flex-wrap items-center justify-between gap-3">
      <div class="flex items-center gap-3">
        <img
          src="{% static 'sportsday/images/harrow-international-logo.png' %}"
          alt="Harrow International Bengaluru logo"
          class="h-10 w-10 object-contain"
          loading="lazy"
          decoding="async"
        />
        <div>
          <a href="{% url 'sportsday:dashboard' %}" class="text-lg font-semibold tracking-wide text-ink">
            Harrow Bengaluru Sports Day
          </a>
          {% if active_meet %}
            <p class="text-xs text-slate-600">Active meet: {{ active_meet.name }}</p>
          {% endif %}
        </div>
      </div>

      {% with url_name=request.resolver_match.url_name %}
      <nav class="hidden md:flex items-center gap-2 text-sm" aria-label="Primary">
        <a href="{% url 'sportsday:dashboard' %}"
           class="px-3 py-2 rounded-md transition {% if url_name == 'dashboard' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name == 'dashboard' %}aria-current="page"{% endif %}>Dashboard</a>

        <a href="{% url 'sportsday:meet-list' %}"
           class="px-3 py-2 rounded-md transition {% if url_name in 'meet-list,meet-detail,meet-create,meet-update' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name in 'meet-list,meet-detail,meet-create,meet-update' %}aria-current="page"{% endif %}>Meets</a>

        <a href="{% url 'sportsday:students' %}{% if active_meet %}?meet={{ active_meet.slug }}{% endif %}"
           class="px-3 py-2 rounded-md transition {% if url_name == 'students' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name == 'students' %}aria-current="page"{% endif %}>Students</a>

        <a href="{% url 'sportsday:teachers' %}"
           class="px-3 py-2 rounded-md transition {% if url_name == 'teachers' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name == 'teachers' %}aria-current="page"{% endif %}>Teachers</a>

        <a href="{% url 'sportsday:sport-types' %}"
           class="px-3 py-2 rounded-md transition {% if url_name == 'sport-types' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name == 'sport-types' %}aria-current="page"{% endif %}>Sports</a>

        <a href="{% url 'sportsday:events' %}{% if active_meet %}?meet={{ active_meet.slug }}{% endif %}"
           class="px-3 py-2 rounded-md transition {% if url_name in 'events,event-detail' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name in 'events,event-detail' %}aria-current="page"{% endif %}>Events</a>

        <a href="{% url 'sportsday:leaderboards' %}{% if active_meet %}?meet={{ active_meet.slug }}{% endif %}"
           class="px-3 py-2 rounded-md transition {% if url_name == 'leaderboards' %}bg-sky/10 text-sky-700 font-semibold{% else %}hover:bg-slate-200{% endif %}"
           {% if url_name == 'leaderboards' %}aria-current="page"{% endif %}>Leaderboards</a>
      </nav>
      {% endwith %}
    </div>
  </header>

  <main class="flex-1 w-full">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-6 space-y-6">
      {% if messages %}
        <div class="space-y-3">
          {% for message in messages %}
            <div class="rounded-lg border border-slate-200 bg-white px-4 py-3 text-sm text-ink shadow">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      {% block content %}{% endblock %}
    </div>
  </main>

  {% block mobile_nav %}{% endblock %}

  <footer class="bg-white border-t border-slate-200">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-4 text-xs text-slate-600">
      &copy; {% now "Y" %} Pavonify Sports Day
    </div>
  </footer>
</body>
</html>
